<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <form id="eventForm">

        <div>
            <label for="event">Eventname</label>
            <input type="text"
                id="event"
                name="event"
                required>
        </div>

        <button type="submit" id="submit">CreateEvent</button>
    </form>
    <a href="/profile.html"> Back to all Events</a>

    <script>
        window.onload = async function () {

        let loginCheck = new XMLHttpRequest();
        loginCheck.open("GET", "/auth");
        loginCheck.send();

        loginCheck.onload = async function(){

            if(loginCheck.status === 200){

            document.getElementById('eventForm').addEventListener('submit', function (e) {
                e.preventDefault();
                const formData = new FormData(this);
                const data = Object.fromEntries(formData);

                fetch('/profile/events', {
                        method: 'PUT',
                        headers: {
                        'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(data),
                    });

                    let textfield = document.getElementById("event");
                    textfield.value = "";
                });
            } else{
                window.location.href = '/auth.html';
            }
        }}

        console.log("I am in");

    </script>
</body>
</html>